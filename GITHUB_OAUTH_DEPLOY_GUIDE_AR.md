# دليل إعداد GitHub OAuth للنشر

هذا الدليل يشرح كيفية استخدام GitHub OAuth للسماح للمستخدمين بنشر مواقع البورتفوليو الخاصة بهم على GitHub Pages.

## الإعداد المطلوب

### 1. إنشاء تطبيق GitHub OAuth

1. اذهب إلى [GitHub Developer Settings](https://github.com/settings/developers)
2. انقر على "New OAuth App"
3. املأ المعلومات التالية:
   - **Application name**: Portfolio Maker
   - **Homepage URL**: https://example.com (استبدلها برابط موقعك)
   - **Authorization callback URL**: https://example.com/api/auth/callback/github
4. انقر على "Register Application"
5. احصل على Client ID و Client Secret

### 2. إعداد متغيرات البيئة

أضف المتغيرات التالية إلى ملف `.env.local`:

```
GITHUB_ID=your-client-id
GITHUB_SECRET=your-client-secret
NEXTAUTH_URL=https://example.com
NEXTAUTH_SECRET=your-secret-key
```

### 3. نطاق الصلاحيات المطلوبة

تأكد من أن نطاق OAuth يتضمن:
- `read:user`: للوصول إلى معلومات الملف الشخصي للمستخدم
- `user:email`: للوصول إلى عنوان البريد الإلكتروني للمستخدم
- `repo`: للوصول إلى المستودعات وإنشائها

## كيفية عمل النظام

### تدفق المصادقة

1. المستخدم ينقر على زر "نشر على GitHub"
2. إذا لم يكن لديه الصلاحيات المطلوبة، سيتم توجيهه إلى GitHub للموافقة
3. بعد الموافقة، يتم توجيه المستخدم مرة أخرى إلى التطبيق مع رمز الوصول
4. يتم استخدام رمز الوصول لإجراء عمليات على GitHub API نيابة عن المستخدم

### آلية النشر

1. يقوم النظام بإنشاء مستودع في حساب GitHub للمستخدم
2. يتم إنشاء ملفات HTML وCSS وJavaScript اللازمة
3. يتم تفعيل GitHub Pages للمستودع
4. يتم توفير رابط الموقع المنشور للمستخدم

## استكشاف الأخطاء وإصلاحها

### مشاكل المصادقة

- إذا ظهر خطأ "Bad verification code"، تحقق من صحة `GITHUB_SECRET`
- إذا ظهر خطأ "Invalid redirect_uri"، تأكد من تطابق رابط callback في إعدادات GitHub OAuth

### مشاكل النشر

- إذا فشل النشر بسبب نقص الصلاحيات، حاول تسجيل الخروج وإعادة تسجيل الدخول للحصول على صلاحيات جديدة
- إذا كان هناك خطأ في إنشاء المستودع، تحقق من صحة اسم المستودع وتأكد من أنه لا يوجد مستودع بنفس الاسم

## الأمان

- رمز الوصول لا يتم تخزينه بشكل دائم في قاعدة البيانات، بل يتم استخدامه فقط خلال جلسة المستخدم
- جميع عمليات API تتم من خلال طلبات HTTPS آمنة
- يمكن للمستخدمين إلغاء الوصول في أي وقت من إعدادات GitHub الخاصة بهم
